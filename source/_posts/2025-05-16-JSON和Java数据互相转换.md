---
title: 使用FastJson来进行JSON和Java数据互相转换
date: 2025-05-16 09:09:38
tags: JSON
---

使用alibaba的fastjson来进行转换

需要先导入jar包

```xml
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>fastjson</artifactId>
    <version>1.2.47</version>
</dependency>
```

# 解析JSON数据

拿以下的json数据进行举例，一层层解析json对象和json数组，最终得到picUrl的值

解析过程：获取到该字符串=》解析该字符串为json对象=》解析该json对象中的json数组list=》解析list数组中的元素（json对象）=》通过解析出来的json对象，再进行解析faces的json数组=》解析faces中的元素（json对象）=》通过解析出来的json对象获取到picUrl的值

{}表示这是一个json对象，[]表示这是一个json数组

```json
{//json对象
  "code": "0",
  "msg": "SUCCESS",
  "data": {//json对象
    "total": 1,
    "pageSize": 20,
    "pageNo": 1,
    "list": [//json数组
      {//json对象
        "humanId": "7d29168c367378d_0887866a80c",
        "name": "张三",
        "registerGender": "male",
        "mainCertificate": {
          "certificateType": "111",
          "certificateNumber": "320219999999999999"
        },
        "faces": [//json数组
          {//json对象
            "picId": "80270rfyh2980hf299u9",
            "picType": "1000",//获取到实际值
            "picUrl": "http://127.0.0.1:8080/pic?4dda-16e4611i4c33pb"
          }
        ],
        "libs": [
          {
            "libCode": "31232124",
            "libName": "库1"
          }
        ],
        "bornTime": "2011-06-10",
        "residenceCountyCode": "330602"
      }
    ]
  }
}
```

**1.首先调用接口获取这么一串字符串**

```typescript
Map<String, Object> params = new HashMap<>();
params.put("sfzh", data.get(idNumberName));
params.put("type", type);
String res = easyOkClient.get("http://127.0.0.1:18891/file/op/test", params);
```

**2.校验res是否合法**

```Java
if (StringUtils.isEmpty(res)) {
    log.warn("接口返回结果为空");
    return null;
}
```

**3.将res字符串解析为****json****对象(resObject )**

json数据最外层的{}表示这是一个json对象

```Java
JSONObject resObject = JSONObject.parseObject(res);
```

**4.解析****json****对象(resObject )中的字符串**

因为前面已经获取到了最外层的json对象，所以可以通过该json对象使用getString方法来获取json对象里的值

```java
String code = jsonObject.getString("code");
if (!"0".equals(code)) {
    String msg = jsonObject.getString("msg");
    log.warn("接口调用失败，code={}, message={}", code, msg);
    return null;
}
```

**5.解析****json****对象(resObject )里的json对象(dataObj)**

因为在在外层的json对象里的data存在{}，说明data也是一个json对象，通过getJSONObject来获取json对象

```javascript
JSONObject dataObj = jsonObject.getJSONObject("data");
if (dataObj == null) {
    log.warn("data 字段为空");
    return null;
}
```

**6.解析****json****对象（dataObj）里的json数组（faces）**

在data的json对象里的faces是一个json数组，所以通过getJSONArray来获取json对象中的json数组

```javascript
JSONArray listArray = dataObj.getJSONArray("list");
if (listArray == null || listArray.isEmpty()) {
    log.warn("list 数组为空");
    return null;
}
```

**7.获取****json****数组（listArray）中的元素（json对象/String字符串）**

以下情况为json数组中存在json对象（因为在示例中，faces:[{},{}]，说明faces数组里存放的是json对象；如果faces:["",""]这样的情况，那么直接通过faces.getString就可以获取数组中的元素

```javascript
for (int i = 0; i < listArray.size(); i++) {
    JSONObject person = listArray.getJSONObject(i);

    JSONArray faces = person.getJSONArray("faces");
    if (faces != null && !faces.isEmpty()) {
        for (int j = 0; j < faces.size(); j++) {
            //先获取faces数组中的json对象
            JSONObject face = faces.getJSONObject(j);
            //通过getString来获取json对象中的字符串值
            String picUrl = face.getString("picUrl");

            if (!StringUtils.isEmpty(picUrl)) {
                log.info("提取到的 picUrl：{}", picUrl);
                return picUrl; // 返回第一个有效 url
            }
        }
    }
}
```

# Java和JSON数据互转

## Java对象转为JSON字符串

```typescript
import com.alibaba.fastjson.JSON;
 
public class FastjsonDemo {
    public static void main(String[] args) {
        // 创建一个Java对象
        User user = new User();
        user.setId(1);
        user.setName("John Doe");
        user.setEmail("john.doe@example.com");
 
        // 使用Fastjson将Java对象转换为JSON字符串
        String jsonString = JSON.toJSONString(user);
        System.out.println(jsonString);
    }
}
 
class User {
    private int id;
    private String name;
    private String email;
    // 省略getter和setter方法
}
```

## JSON字符串转为Java对象

```typescript
import com.alibaba.fastjson.JSON;
 
public class FastjsonDemo {
    public static void main(String[] args) {
        // JSON字符串
        String jsonString = "{\"email\":\"john.doe@example.com\",\"id\":1,\"name\":\"John Doe\"}";
 
        // 使用Fastjson将JSON字符串转换为Java对象
        User user = JSON.parseObject(jsonString, User.class);
        System.out.println(user.getName()); // 输出 John Doe
    }
}
 
class User {
    private int id;
    private String name;
    private String email;
    // 省略getter和setter方法
}
```

## Java对象和JSONObject相互转换

```typescript
import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;
 
public class FastjsonDemo {
    public static void main(String[] args) {
        // 创建一个Java对象
        User user = new User();
        user.setId(1);
        user.setName("John Doe");
        user.setEmail("john.doe@example.com");
 
        // Java对象转JSONObject
        JSONObject jsonObject = (JSONObject) JSON.toJSON(user);
        System.out.println(jsonObject.getString("name")); // 输出 John Doe
 
        // JSONObject转Java对象
        User userFromJson = JSON.toJavaObject(jsonObject, User.class);
        System.out.println(userFromJson.getName()); // 输出 John Doe
    }
}
 
class User {
    private int id;
    private String name;
    private String email;
    // 省略getter和setter方法
}
```
